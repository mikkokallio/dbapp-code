{% extends "layout.html" %}
{% block content %}

<h1 class="title">
  {{ event.title }}
</h1>
<h2 class="subtitle">
  Upcoming event
</h2>

<div class="box has-background-primary-light">
  <div class="columns">
    <div class="column">
      <i class="fas fa-calendar"></i> {{ event.date.strftime("%a %d %b") }}
    </div>
    <div class="column">
      <i class="fas fa-clock"></i> {{ event.time.strftime("%H:%M") }}
    </div>
    <div class="column">
      <i class="fas fa-map-marker"></i> To be added
    </div>
    <div class="column">
      Organized by {{ event.hostname }}
    </div>
  </div>

  <div class="block"><i class="fas fa-quote-left fa-2x fa-pull-left"></i> {{ event.description }}</div>
  <form action="/signup" method="POST">
    <div class="field has-addons">
      {% if session.username != event.hostname %}
        {% if user_going %}
        <button id="button" type="submit" class="button is-small is-success" onclick="showSpinner()">
          <i class="fa fa-check"></i>
        </button>
        {% else %}
        <button id="button" type="submit" class="button is-small is-primary" onclick="showSpinner()">
          <i class='fa fa-question'></i>
        </button>
        {% endif %}
      {% else %}
      <p class="button is-static is-small">
        <i class="fa fa-check"></i>
      </p>

      {% endif %}

      <span>&nbsp; {{ going }} are going</span>
   </div>
    <input type="hidden" name="event_id" value="{{ id }}">
  </form>
</div>
<div class="block">
  <h2 class="subtitle">
    Comments
  </h2>
</div>

<div>
  <div class="notification">
    <div class="columns is-mobile is-size-7">
      <div class="column is-one-fifth">
        {{ session.username }}
        <i class="fas fa-star"></i>
      </div>
      <div class="column">
        now
      </div>
    </div>
    <form action="/write_comment" method="POST">
      <div class="field has-addons">
        <button id="button" type="submit" class="button is-small is-primary" onclick="showSpinner()"><i class='fa fa-share'></i></button>
        <input class="input is-small" type="text" name="comment" placeholder="Write a comment...">
     </div>
      <input type="hidden" name="event_id" value="{{ id }}">
    </form>
  </div>

  {% for unit in comments %}
  <div class="notification">
    <div class="columns is-mobile is-size-7">
      <div class="column is-one-fifth">
        <a class="js-modal-trigger" data-target="user-modal{{ unit.username }}">{{ unit.username }}</a>
        {% if session.username == unit.username %}
        <i class="fas fa-star"></i>
        {% endif %}

      </div>
      <div class="column">
        {{ unit.created_at.strftime("%a %d %b %H:%M") }}
      </div>
    </div>
    <div>
      {{ unit.comment }}
    </div>
  </div>

  {% include "user_modal.html" %}
  {% endfor %}

</div>
{% endblock %}